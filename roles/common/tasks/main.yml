---
# The common tasks

- name: Install required packages
  yum: name={{ item }} state=installed
  with_items:
   - ntp
   - sudo
   - scsi-target-utils
   - dbus
   - libselinux-python
  notify: restart services

- name: install iptables
  yum: name={{ item }} state=installed
  with_items:
    - iptables
    - iptables-services

- name: add iptables
  template: src=iptables.j2 dest=/etc/sysconfig/iptables
  notify: restart iptables

- name: iptables restart
  shell: systemctl restart iptables

- name: Create the hosts entry.
  template: src=hosts.j2 dest=/etc/hosts

- name: start the openvswitch service.
  service: name=openvswitch state=started

- name: Disable selinux dynamically
  shell: creates=/etc/sysconfig/selinux.disabled setenforce 0 ; touch /etc/sysconfig/selinux.disabled

- name: Disable SELinux in conf file
  copy: src=selinux dest=/etc/sysconfig/selinux
